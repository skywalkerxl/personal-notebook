---
title: 从输入一个URL到浏览器页面展示都经历了哪些过程？
date: 2018-07-22 20:22:28
tags: [笔试面经, 计算机网路]
categories: 计算机网络
---
![](https://wave-1253805456.cos.ap-chengdu.myqcloud.com/WaveBlog/2018072502.jpg)
<!-- more -->
首先列出基本的流程：

1. 从浏览器输入URL后到开启网络请求线程（这里包括浏览器进程线程相关知识）
2. 开辟网络请求线程后发起HTTP请求（DNS查询，tcp/ip，五层协议）
3. 服务器和后端接收到HTTP请求（这一部分涉及到负载均衡、后台处理、web服务器相关知识）
4. 前端与后端进行HTTP交互（这里其实包括HTTP请求头部、如何保存用户会话、编码解码，代码压缩）
5. 在这中间有着缓存的问题（强缓存与协商缓存）
6. 浏览器接收到http数据包的解析流程（网页性能管理部分，这里有html dom和cssom的构建部分）
7. CSS的解析
8. JS的解析

而这些只是基本的过程，我们需要一步一步去剖析这些过程。

## 一、浏览器输入URL后开启网络请求线程

我们首先需要明白的是，浏览器是多进程的
进程包括浏览器的主控进程、插件进程、GPU进程、tab页进程，如下
1. Broswer进程：浏览器的主进程，负责主控和协调，有且只有一个
2. 第三方插件的进程：每个插件会对应一个进程，当然只有在使用该插件时才会开辟进程
3. GPU进程：最多一个，用于页面的GPU加速渲染
4. 浏览器渲染进程（内核）：默认来说一个tab页一个进程，当然有时候会有优化比如说多个空白页会合并成一个进程

我们可以将每一个tab页看作一个进程，并包括以下线程：
1. GUI线程
2. 网络请求线程
3. js线程
4. 定时器线程
5. 事件触发线程

知道了上述内容之后，我们需要知道的是，用户输入的URL一般包括：

* protocal 协议头

* host 主机名

* port 端口号

* path 目录路径

* query 查询参数

* fragment 片段标识符

我们以` http://www.example.com:80/dir/index.html?uid=1#ch1 `为例

那么在这里我们可以划分如下

* protocal ：`http://`
* host ：`www.example.com`
* port：`80`
* path：`dir/index.html`
* query：`uid=1`
* fragment：`ch1`

如果浏览器解析到的URL是http请求，那么会单独开辟网络请求的线程来发起http请求

## 二、开辟网络请求线程到发起HTTP请求

我们需要掌握的是与HTTP关系密切的协议：IP、TCP和DNS

这里涉及到三个重要的知识点

1. 负责域名解析的DNS服务
2. 负责传输的IP协议
3. 确保可靠性的TCP协议

![《图解HTTP》 1.6章节](http://otqkq32hb.bkt.clouddn.com/20180722_01.png)

### 1. 负责域名解析的DNS服务



### 2. 负责传输的IP协议



### 3. 确保可靠性的TCP协议



## 三、服务器和后端接收到HTTP请求

这里需要知道的知识点有：

* 负载均衡
* 后台处理

关于负载均衡这里先不谈，而在后台处理方面，则是登录验证鉴权等一系列后台逻辑

## 四、浏览器与服务器的HTTP交互

这一部分我们需要掌握的知识点有：

* HTTP首部
* HTTP状态码
* 基于HTTP的功能追加协议：`SPDY`、`WebSocket`、`HTTP/2.0`、`WebDAV`

关于第三点会单独写一篇文章来聊聊HTTP

## 五、存在于这之间的缓存

我们需要知道的是，缓存分为强缓存（200 from cache）和弱缓存（304）

## 六、浏览器接收到http数据包的解析流程

这部分主要是浏览器在拿到html之后的解析渲染的流程,大致分为以下几步：

1. 解析HTML，构建DOM树
2. 解析CSS，构建CSS规则树
3. 合并DOM树和CSS规则树，生成render树
4. 布局render树（Layout/reflow），负责元素尺寸、位置的计算
5. 绘制render树（paint），绘制页面像素信息
6. 浏览器会将各层的信息发送给GPU，GPU会将各层合成（composite）,显示在屏幕上

这部分内容可以参考最后的参考链接


## 七、CSS的解析


## 八、JS的解析


## 参考文献：

[从输入URL到页面加载的过程？如何由一道题完善自己的前端知识体系！](https://zhuanlan.zhihu.com/p/34453198?group_id=957277540147056640)
[网页性能管理详解-阮一峰](http://www.ruanyifeng.com/blog/2015/09/web-page-performance-in-depth.html)