---
date: 2018-11-17 10:35:20
title: 组合模式
tags: ['design pattern']
categories: ['design pattern']
---

组合模式是利用小的子对象来组成大的对象，而这些小的子对象有可能是由更小的孙子对象构成的

![1542425712782](assets/1542425712782.png)

我们不妨假设有如下三种指令 `关门(closeDoorCommand), 打开电脑(openPcCommand), 打开QQ(openQQCommand)`

在不使用组合模式的条件下，需要分别这三种指令来达到我们的目标，现在我们为了方便使用这三条指令将其组合成一个超级指令 `macroCommand`

`MacroCommand`类代码如下

``` javascript
function MacroCommand() {
    return {
        commandList: [],
        add: function(command){
            this.commandList.push(command);
        },
        execute: function(){
            for(let i = 0, command ; command = this.commandList[i++];){
                command();
            }
        }
    }
}
```

使用方式如下

``` javascript
let macroCommand = new MacroCommand();

let task1 = function(){};
let task2 = function(){};
let task3 = function(){};

// 添加指令
macroCommand.add(task1);
macroCommand.add(task2);
macroCommand.add(task3);

// 执行指令
macroCommand.execute();
```

给按钮绑定指令

``` javascript
let setCommand = (function(command, button){
    document.getElementById(button).onclick = function(){
        command.execute();
    }
})(macroCommand, button);
```

