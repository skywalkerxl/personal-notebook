---
title: 实习项目介绍暨专业实践汇报
date: 2018-09-14 09:22:53
tags: [project]
categories: [project]
---

项目内容及流程梳理

1. 梅钢原料智慧化项目中与上海宝信总部L3级电文通讯的设计与实现 ( 4月 ~ 至今 )
2. 潍坊特钢项目数据采集系统研发 （6月 ~ 9月）
3. 东轻制造执行系统(MES)建设项目研发 （7月 ~ 至今）
4. 梅钢原料智慧化项目中报表汇总，状态分析，设备检修模型（8月 ~ 至今）

### 1.  梅钢原料智慧化项目中与上海宝信总部L3级电文通讯的设计与实现 

#### 项目时间

​	2018年4月 ~ 至今

#### 项目概述

​	为配合原料智慧化料场改造，并且结合铁区管理系统实际使用情况及新的管理业务需求，对铁区管理原料功能进行改造、优化，从而更好满足原料智慧化料场工程后的炼厂原料管理及生产管理的需求。

#### 主要计划

近期的主要计划为完成与原料L2系统的外部接口设计部分，其中涉及到的电文信息条目如下:

| 电文号 | 中文名称                            |
| ------ | ----------------------------------- |
| Y2DQ01 | 日一次料场受入作业实绩              |
| Y2DQ02 | 日综合煤场受入作业实绩              |
| Y2DQ03 | 日混匀矿堆积、输出作业实绩          |
| Y2DQ04 | 日烧结矿输送作业实绩                |
| Y2DQ05 | 日焦炭输送作业实绩                  |
| Y2DQ06 | 日高炉用块矿&落地烧结矿加槽作业实绩 |
| Y2DQ07 | 日煤供给作业实绩                    |
| Y2DQ08 | 日取料机工作状况实绩                |
| Y2DQ09 | 日堆料机工作状况实绩                |
| Y2DQ10 | 日其他有关设备工作状况实绩          |
| Y2DQ11 | 班BF矿石库供给作业实绩              |
| Y2DQ12 | 班DL原料槽供给作业实绩              |
| Y2DQ13 | 班烧结矿输送作业实绩                |
| Y2DQ14 | 班混匀矿输送作业实绩                |
| Y2DQ15 | 班配煤槽供给作业实绩                |
| Y2DQ16 | 班槽下烧结粉输送作业实绩            |
| Y2DQ17 | 班槽下焦粉输送作业实绩              |
| Y2DQ18 | 班原料处理作业记录                  |
| Y2DQ19 | 班混匀矿堆积作业实绩                |
| Y2DQ20 | 班混匀矿堆积大堆实绩                |
| Y2DQ21 | 班混匀矿堆1-3BLCOK堆积实绩          |
| Y2DQ22 | 高炉供给作业吨公里日实绩            |
| Y2DQ23 | 烧结供给作业吨公里日实绩            |
| Y2DQ24 | 炼焦供给作业吨公里日实绩            |
| Y2DQ25 | 原料设备信号电文                    |
| Y2DQ26 | 槽位信息                            |
| Y2DQ27 | 料场信息                            |
| Y2DQ28 | 当前执行流程信息                    |
| Y25621 | 混匀配料班实绩信息                  |
| Y25614 | 混匀下料量信息                      |
| Y25615 | 高炉焦矿仓槽信息                    |
| Y25627 | 皮带瞬时流量信息                    |
| Y2DQ29 | 煤焦处理班报-焦输送实绩             |
| Y2DQ30 | 煤焦处理日报-焦输送实绩             |
| Y2DQ31 | 皮带作业计划                        |
| Y2DQ32 | 班焦炭输送作业实绩                  |
| Y2DQ33 | 卸船推荐计划                        |
| Y2DQ34 | 混匀变料状态跟踪                    |
| DQY201 | 匀矿大堆堆积计划主信息              |
| DQY202 | 匀矿大堆堆积计划子信息              |
| DQY203 | 匀矿大堆堆积4BLOCK调整计划主信息    |
| DQY204 | 匀矿大堆堆积4BLOCK调整计划子信息    |
| DQY205 | 混匀配料计划                        |
| DQY206 | 混匀配料计划子信息                  |
| 56Y201 | 卸船计划                            |
| DQY207 | 进厂船期信息                        |
| DQY208 | 烧结、炼焦、高炉的变料计划          |
| DQY209 | 设备检修计划                        |
| DQY210 | 火车的过磅信息                      |
| DQY211 | 原料码头泊位实时信息                |
| DQY212 | 船舶状态信息                        |
| DQY213 | 设备检修计划                        |
| DQY214 | 品名信息                            |

#### 项目技术

1. 编程语言：C# 
2. 数据库：SQL Server
3. 开发工具：Visual Studio 2013  宝信TTA

#### 项目实现

1. 由于发送来的电文包含循环电文与非循环电文，其中循环电文又包含循环部分与非循环部分，此时另外新增一个表记录循环电文的循环部分配置则可以很好的分离开复杂的电文配置信息。
2. xcom获取到数据之后会存储到xcom数据库中的ReceivedMessageBufferLog表中，ReceivedManagerSql类会从该表中获取数据，并通过MessageDB类与DBHelperSql类辅助获取相对应的电文配置信息与循环部分配置信息（如果该电文是循环电文），并存储至相应的电文表中，至此，接收电文处理完毕。
3. 若要发送消息至对方，则需要将电文数据库中的表数据存储至xcom表中的SentMessageBuffer表中，同样借助于MessageDB类与DBHelper类可以由电文字段获取到电文的表配置信息，再加上电文表中的值，则可以将每条数据拼成一个长字符串并存储至SendMessageBuffer表中，由xcom发送。

#### 技术难点

1. 数量较多的电文配置

   除了基本的53张表之外，遇到需要循环电文则需要另外配置一条循环电文信息，此外部分表的字段非常多，甚至达到近200个字段，除了字段数量之外，不同字段不同的数据类型也需要一一配置，小数位与整数位不能出现一点错误，否则拼接字符串时会导致数据错误，对方解析也会出错，造成数据错误，严重则会造成该条数据无法读取。
   
2. 处理包含小数位的数据项

   在遇到包含小数位的数据项时，需要对该条数据做移位和补位处理，从而达到数据值位数解析正确，而对移位和补位数的判断则很容易编写出错，造成整条数据过长或小数位不正确。

3. 处理循环电文信息

   由于只有部分电文是循环电文，而循环电文中只有部分是循环项，另外则是非循环项，这部分除了需要另写配置之外，还需要单独编写方法来处理此类电文，此外在向对方发送电文时，也需要对各部分进行查找组合，形成一条正确的电文数据，这其中也会出现部分问题，需要由足够的耐性。

4. 调试对接时出现的问题

   由于双发并不是直接通信，而是由系统中转部来中转消息，这就对消息到达的及时性产生了影响，在期间的几次调试过程中，由于对方或自身的xcom问题，导致了信息的无法发送和接收。此外由于电文配置文档会不定期更新，这也就要求双方都需要以最新的文档来重新配置信息，一旦未及时更新配置信息则会造成数据处理时发生偏差。

### 2. 潍坊特钢数据采集系统研发

#### 项目时间

​	2018年6月 ~ 2018年9月

#### 项目概述

​	由于潍坊特钢原有生产数据皆是人工抄录、人工处理，且部分数据不支持自动化采集功能，因此本次新建潍坊特钢炼钢综合数据采集系统，实现生产计划接收、生产过程数据的跟踪和收集等功能，尽量减少人工录入，确保生产数据准确性，对生产数据进行采集并上传给MES系统，实现数据不落地。

#### 主要计划

​	数据采集系统的主要功能包括数据采集、生产作业计划接收处理、生产过程跟踪、生产实绩收集、物料信息管理、外部通讯接口管理、用户管理。

#### 项目技术

1. 编程语言：C# 
2. 使用框架：Ent Frame （公司内部的企业级应用开发框架）
3. 数据库：SQL Sever 
4. 开发工具：Visual Studio 2013 + SQL Server Management Studio 

#### 项目实现

1. 该项目主要分为高炉线和钢棒线两个模块，业务流程大致为原料从入炉到出炉再到轧制和称重。
2. 代码实现方面，项目整体分成前台画面展示部分和后台业务逻辑部分以及 Ent Frame 框架核心部分，后台又分成三层，分别是 MODEL ，DAL和 Controller 三个部分，MODEL主要为存放实体，DAL 存放数据访问，Controller部分实现项目主体的业务逻辑，前后台交互通过 EntFrame 框架中 EntInfo 来传递信息

#### 技术难点

1. 需要理清楚项目的整体业务逻辑
2. 需要理解 Ent Frame 框架整体运作流程，并编写可维护性高，注释良好的代码

### 3. 东轻铝数据采集系统研发

#### 项目时间

​	2018年7月 ~ 至今

#### 项目概述

​	项目为东北轻合金铝板制造提供数据采集功能，数据采集系统是信息化系统建设的基础，它介于MES系统和基础自动化系统之间，负责生产实绩数据收集、过程数据采集及生产过程跟踪监视，并将采集到的数据按照MES系统的要求组织，发送给MES系统。同时，数据采集系统提供友好的人机界面，将从MES系统接收到的计划、命令等数据，以及从L1系统实时采集到的数据进行加工处理，以直观的形式呈现给操作工，指导各工序进行生产。

#### 主要计划

加热炉和轧机区域原厂家有L2系统，MES系统直接和L2系统对接实现生产计划等必要信息的下发。

加热炉：数据采集系统周期性或根据L1触发信号自动收集各加热炉温度实绩数据，提供数据存储、画面查询展示功能，并及时上传给MES系统；

轧机：数据采集系统根据每道次轧制结束或其他关键触发信号实时收集轧制的厚度、宽度、长度、温度等主要实际数据，提供数据存储、画面查询展示功能，并及时上传给MES系统；轧机L1的HMI服务器中已经实现了物料信息的跟踪，所以数采系统采集到的物料信息和工艺实绩数据作了匹配。

数采系统接收处理MES系统下发的辊底炉/时效炉生产计划，主要包括批号、熔次号、合金及牌号、计划生产日期、来料规格、数量、工艺要求等。

实物装炉时需人工在数采画面的计划列表中选择对应的物料信息，并选择实际装入的炉座号，确认投料。后续的升温、保温过程中数采系统会定周期采集温度数据并保存。

热处理结束出炉时人工选择炉内物料信息确认出炉，数采系统将匹配好的物料信息、工艺实绩上传给MES系统。

#### 项目技术

1. 编程语言：C#
2. 使用框架：Ent Frame（公司内部的企业级应用开发框架）
3. 数据库：SQL Server 
4. 开发工具：Visual Studio 2013 + SQL Server Management Studio

#### 项目实现

该采集系统分为五个模块，熔炼铸造、均热炉、锯切、铣面以及中厚板数据采集

1. 熔铸计划模块包括：熔铸计划、1#线熔炼铸造作业、熔铸作业实绩
2. 均热炉模块包括：均热炉作业、均热炉实绩
3. 锯切模块包括：锯切作业、锯切实绩
4. 铣面：铣面作业、铣面实绩
5. 中厚板数采：加热炉实绩、轧制实绩、辊底炉实绩、时效炉作业、时效炉实绩

#### 技术难点

1. 需要理清楚项目的业务逻辑

### 4. 梅钢原料智慧化项目中报表汇总，状态分析及设备检修模型

#### 项目时间

​	2018年8月 ~ 至今

#### 项目概述

​	原料智慧化中需要对已采集到的数据做报表汇总以及状态分析，通过已有数据表进行分析并得出结果。

#### 主要计划

​	按照班或日来统计料场、综合煤场、烧结矿、焦炭等作业量，设备的作业量需要统计取料机、堆料机以及其他设备的作业实绩。

#### 项目技术

1. 编程语言： C# Python
2. 数据库：SQL Server , Oracle 
3. 开发工具： Visual Studio 2013 + SQL Server Management Studio + DataGrip 

#### 项目实现

1. 需要采集的数据都存储在另一份数据库中的 PD_FLOW_PATHRUN_HISTORY 表中，表中提供班次、班次开始时间、班次结束时间、设备开始时间、设备结束时间等用于报表汇总的时间节点关键信息。
2. 除了这些时间节点信息之外，还需要通过关联堆场表 FT_LOCATION_SET 、仓槽表 GT_LOCATION_BIN 等判断其属于哪一座料场。
3. 分析得出这些统计信息之后，再插入到相应的表信息当中。

#### 技术难点

项目的技术难点主要在于分清每张统计报表要统计的内容，由于要统计的报表数目达到20多张，需要耐心并逐步的完成每张报表的统计以及状态分析。